var $viewbinder$fd=function(e){var t="data-viewbind-pageview";var n="data-viewbind-init";var r="data-viewbind-model";var s="data-viewbind-notify";var o="data-viewbind-cast";var u="data-viewbind-event";var a="data-viewbind-call";var f="data-viewbind-view";var l="data-viewbind-viewarea";var c="data-viewbind-viewdelay";var h="data-viewbind-action";var p="data-viewbind-effect";var d=f+"-x";var v=f+"-error";var m="viewbind";var g="."+m;var y="";var b={subscribers:[],subscribe:function(e){if(e){if(typeof e==="function"){this.subscribers.push(e)}}},error:function(e){this.notifySubscribers(e||{},1);console&&console.error(e)},warn:function(e){this.notifySubscribers(e||{},2);console&&console.warn(e)},notifySubscribers:function(e,t){(function(n){setTimeout(function(){t=t||1;var r=n.subscribers.length;for(var i=0;i<r;i++){try{n.subscribers[i](e,t)}catch(s){console&&console.error("Subscriber Notification Malfunction")}}},0)})(this)}};var w=function(){w.id=w.id?w.id+1:1;return w.id};var E=function(t){if(t){e("["+f+"='"+t+"']").removeAttr(c)}};var S=function(t){if(t){e("["+f+"='"+t+"']").empty()}};var x=function(t){if(t){if(t.split("=")[1]){if(e("["+f+"='"+t+"']").size()){var n=e("["+f+"='"+t+"']");n.removeAttr(c).removeAttr(d).empty()}else{e("body").append('<div style="display:none" class="viewbind"  data-viewbind-view="'+t+'"></div>')}}else{var r=e("["+f+"='"+t+"']");r.removeAttr(c);r.removeAttr(d);r.html("")}$viewbinderViewLoader("["+f+"='"+t+"']")}};var T={load:x,unload:S,reload:x};var N=function(n,r){var i=e("script[type='text/plain']["+t+"='"+n+"']");var s=i.size();var o=s&&i.html();s&&r&&r(o);return s};var C=function(t,n,r,i,s,o){if(o){typeof i==="function"&&i("","","");return}if(t&&r){n=n||"";var u=t;var a=r.split("=");var l=a[0];var c=a[1];var h="";var p=l;if(!c){h=l;p=t;c=n+l}else{h=c;c=n+c;p="["+f+"='"+l+"']"}var d=e(p);s&&d.css("display","none");var v=function(e){d.html(e);d.attr("processed","gas");s?d[s]("fast",function(){typeof i==="function"&&i(e,"","")}):typeof i==="function"&&i(e,"","")};if(d.size()){N(h,v)||e.get(c,v,"html")}else{b.error("destination view area cannot be found as specified at :");b.error(u);typeof i==="function"&&i({},"","")}}};var k={};var L=[];var A=function(t,n){var r={};if(t){var i=t.split("=");if(i[0]==="target"){if(i[1]){r=i[3]?e(i[1])[i[2]](i[3]):e(i[1])[i[2]]()}else{b.error("target not well specified for :");b.error(n)}}else{r=i[1]?e(n)[i[0]](i[1]):e(n)[i[0]]()}}return r};var O=function(e){var t=window;var n=e.split(".");var r=n.length-1;for(i=0;i<r;i++){t=t[n[i]];if(t==undefined)return}return{method:t[n[n.length-1]],context:t}};var M=function(t,n,r){if(t){var i=t.split(",");var s=i.length;for(var o=0;o<s;o++){var u=i[o];if(u){var a=u.split("=");if(a.length===2){var f=a[0];var l=a[1];var c=O(l).method;typeof c==="function"&&n&&f&&e(n).off(f).on(f,function(e){var t=A(r,this);c.apply(this,[e,T,t])})}}}}};var _=function(e,t,n,r,i){};var D=function(e){var t=e.split("(");var n=t[0];var r=t[1].split(")")[0];if(r&&typeof T[n]==="function"){return function(){T[n](r)}}else{b.error("methos supplied is invalid:");b.error(e);return function(){}}};var P=function(t,n,r,i,s){if(t){var o=t.split(",");var u=o.length;for(var a=0;a<u;a++){var f=o[a];var l=false;var c="";if(f){var h=f.split(":");if(h.length===2){var p=h[0];c=h[1];l=c&&D(c);f=p}}if(f){var d=f.split("=");if(d.length===2||l){var v=d[0];var m=d[1]||"i299792458";k[m]=k[m]||[];if(r){var g=k[m];var y=g.length;if(y===0){b.warn("No Listeners registered to receive this notification : "+m)}for(var w=0;w<y;w++){var E=typeof n!=="string"?n:this;typeof g[w]==="function"&&g[w].apply(E,[{},T,i])}}else{n&&v&&e(n).off(v).on(v,function(e){var t=k[m];var n=A(s,this);var r=t.length;l&&l();if(r===0){b.warn("No Listeners registered to receive this notification : "+m)}for(var i=0;i<r;i++){(function(e,t,n,r,i){t.apply(e,[i,n,r])})(this,t[i],T,n,e)}})}}}}}};var H=function(e,t,n){if(e){var r=e.split(",");var i=r.length;for(var s=0;s<i;s++){var o=r[s];if(o){try{var u=O(o);t=u?u.context||t:t;var a=A(n,this);u&&typeof u.method==="function"&&u.method.apply(t,[{},T,a])}catch(f){b.error("could not invoke method "+o+" found in "+e);f.message&&b.error(f.message);b.error(f)}}}}};var B=function(e,t,n){var r=e.split(",");var i=r.length;var s="";for(var o=0;o<i;o++){s="cast="+r[o]}e&&P(s,n||{},true,t||"")};var j=function(e,t,n){var r=A(n,t);e&&B(e,r||"",t)};typeof viewbinder!=="undefined"?b.error("multiple versions of view binder on page"):window.viewbinder={init:function(t){if(t){y=t.rootUrl||y}e(function(){window.$viewbinderViewLoader=function(t){e(t).each(function(){if(e(this).is("["+c+"]")||e(this).attr(d)){}else{try{var t=e(this).attr(f);var n=e(this).attr(p);var i=e(this).is("["+l+"]");if(i){e(this).removeAttr(l)}var m=this;var w=function(n,i,l){var c=e(m).attr(a);if(i=="error"){b.error("failure loading view - "+t+":");b.error(n);b.error(l);e(this).attr(v,true)}(function(t){setTimeout(function(){var n=e(t).attr(f);var i=e(t).attr(s);var l=e(t).attr(a);var c=e(t).attr(u);var p=e(t).attr(o);var d=e(t).attr(r);var v=e(t).attr(h);l&&H(l,t,d);c&&M(c,t,d);p&&P(p,t,false,false,d);i&&j(i,t,d);v&&_(p,t,false,false,d);var m=e(t).find(g);$viewbinderViewLoader(m)},50)})(m)};if(t){C(this,y,t,w,n||"",i)}else{w("","","")}e(this).attr(d,true)}catch(E){b.error("failure loading view - "+t+":");b.error(E);e(this).attr(v,true)}}})};$viewbinderViewLoader(g)})},on:function(e,t){if(typeof t==="function"&&e){k[e]=k[e]||[];k[e].push(t)}else{b.error("Problem Registering Listener for:");b.error(e);b.error("with method:");b.error(t)}},notify:B,view:T,mappings:function(){return{broadcast:k,views:L}},notification:b};e(function(){var t=e("script["+n+"]");if(t.size()){var r={};var i=t.attr(n);if(i){var s=i.split(",");var o=s.length;for(var u=0;u<o;u++){var a=s[u].split("rootUrl:");r.rootUrl=a[1]}}viewbinder.init(r)}});return viewbinder};typeof define==="function"?define(["jquery"],$viewbinder$fd):function(e){e?$viewbinder$fd(jQuery):notification.error("Jquery is not defined")}(jQuery)
